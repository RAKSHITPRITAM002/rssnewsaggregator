<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSS News Aggregator</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1 class="mt-5">RSS News Aggregator</h1>

        <div class="my-4">
            <label for="category-filter" class="form-label">Filter by Category:</label>
            <select id="category-filter" class="form-select" onchange="filterArticles()">
                <option value="all">All</option>
                <option value="Politics">Politics</option>
                <option value="War">War</option>
                <option value="Finance">Finance</option>
            </select>
        </div>

        <div id="news-container" class="mt-3"></div>
    </div>

    <script>
        let articles = [];

        async function fetchNews() {
            const response = await fetch('/news');
            articles = await response.json();
            displayArticles(articles);
        }

        function displayArticles(articles) {
            const container = document.getElementById('news-container');
            container.innerHTML = '';

            articles.forEach(article => {
                const articleElement = document.createElement('div');
                articleElement.className = 'card mb-3 article';
                articleElement.dataset.category = article.category;
                articleElement.innerHTML = `
                    <div class="card-body">
                        <h5 class="card-title">${article.title}</h5>
                        <p class="card-text">${article.summary}</p>
                        <a href="${article.link}" class="btn btn-primary" target="_blank">Read More</a>
                    </div>
                `;
                container.appendChild(articleElement);
            });
        }

        function filterArticles() {
            const filterValue = document.getElementById('category-filter').value;
            const filteredArticles = filterValue === 'all' ? articles : articles.filter(article => article.category === filterValue);
            displayArticles(filteredArticles);
        }

        fetchNews(); // Fetch news when the page loads
    </script>
</body>
</html>
